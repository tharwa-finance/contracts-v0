# Tharwa Bonds V1

Tharwa Bonds enable users to purchase fixed-term, **discounted bonds** redeemable 1-for-1 in `THUSD` at maturity.  Every bond is an ERC-1155 token whose **ID equals the UTC-midnight timestamp of its maturity**.

> Real-world yield generated by the Tharwa ecosystem flows back into the vault, allowing bonds to be offered at a discount while the protocol remains delta-neutral.

---

## How It Works

1. **Purchase** – Call `purchaseBond()` selecting a predefined duration and face amount. The vault:
   - Transfers the **discounted price** (e.g. `0.96 THUSD`) from the buyer.
   - Mints the ERC-1155 bond token to the buyer.
2. **Early Exit** – Call `earlyExit()` before maturity to withdraw early, incurring a linear penalty *(≤ 20 %)* that decays daily.
3. **Redemption** – After maturity anyone can call `redeemBond()` to burn the token and receive `THUSD` **1:1**.



| Duration | Enum | Example Price | Cap |
| -------- | ---- | ------------- | --- |
| 90 days  | `NinetyDays`      | `0.96 THUSD` | 1 M THUSD |
| 180 days | `OneEightyDays`   | `0.93 THUSD` | 2 M THUSD |
| 360 days | `ThreeSixtyDays`  | `0.88 THUSDs` | 4 M THUSD |

All parameters (price, cap, URI, pause) are governed by a multisig holding `DEFAULT_ADMIN_ROLE`.

---

## Repository Layout

```
├── src/                 # Production contracts
│   └── TharwaBondVaultV1.sol
├── script/              # Deployment & interaction scripts
├── test/                # Unit & invariant tests
├── audit/               # Independent audit reports
└── README.md
```

---

## Security & Audits

The codebase was independently audited in **August 2025** with **0 High / 0 Critical** findings.

| Auditor | Report | 
| ------- | ------ |
| PrismSec | [`Bonds audit`](../audits/prismsec_tharwa_bonds.pdf) |

All Medium & Low issues were acknowledged and fixed. See the reports for full details.

---

## Local Development


```bash
# Install Foundry
curl -L https://foundry.paradigm.xyz | bash && foundryup

# Install dependencies
forge install

# Run unit & invariant tests
forge test -vv

# Generate coverage
forge coverage
```



## Deployment Example

```bash
forge script script/TharwaBondVaultV1.s.sol \
  --rpc-url $RPC_URL \
  --private-key $PRIVATE_KEY \
  --broadcast --verify
```

The script is idempotent and supports automatic verification on Etherscan.

---

## License

Released under the **MIT** license – fork, extend, contribute 